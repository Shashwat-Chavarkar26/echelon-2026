<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<link rel="stylesheet" href="style.css">
<title>silvermoonlight</title>
</head>
<body>

<div class="container">
  <div class="page active" id="p1">
    <div class="layout">
      <div class="text">
        <h1>silvermoonlight</h1>
        <p>get updated on your silver stocks daily</p>
        <button onclick="go(2)">ENTER</button>
      </div>
      <div class="visual">
        <img src="silver face1.jpeg" alt="Silver Analysis">
      </div>
    </div>
  </div>

  <div class="page" id="p2">
    <div class="layout">
      <div class="text">
        <h1>ACCESS</h1>
        <p>choose your path</p>
        <div class="options">
          <button onclick="mode('login')">LOG IN</button>
          <button onclick="mode('guest')">EXPLORE AS GUEST</button>
          <button onclick="mode('signup')">SIGN UP</button>
        </div>
      </div>
      <div class="visual">
        <img src="silver thing1.jpeg" alt="Access Portal">
      </div>
    </div>
  </div>

  <div class="page" id="p3">
    <div class="layout">
      <div class="text">
        <h1 id="title">VERIFY</h1>
        <p id="subtitle"></p>
        <div class="inputs" id="fields"></div>
        <button onclick="proceedFromVerify()">PROCEED</button>
      </div>
      <div class="visual">
        <img src="silversilver.jpeg" alt="Verification">
      </div>
    </div>
  </div>

  <div class="page" id="p4">
    <div class="layout">
      <div class="text">
        <h1>OCCUPATION</h1>
        <p>select your role</p>
        <div class="options">
          <button onclick="selectRole(this,'First time here')">First time here</button>
          <button onclick="selectRole(this,'Beginner')">Beginner</button>
          <button onclick="selectRole(this,'Advanced')">Advanced</button>
          <button onclick="selectRole(this,'Professional')">Professional</button>
          <button onclick="selectRole(this,'Other')">Other</button>
        </div>
        <button style="margin-top:20px;" onclick="go(2)">Log in to your account</button>
      </div>
      <div class="visual">
        <img src="silver2.jpeg" alt="Profile">
      </div>
    </div>
  </div>

  <div class="page" id="main">
    <div id="navToggle" onclick="toggleNav()">
      <div></div><div></div><div></div>
    </div>
    <div id="sidebar">
      <h3 onclick="loadPriceChart('monthly')">üìä Prices</h3>
      <h4 onclick="loadGoldComparison()">üí∞ Compare with Gold Rates</h4>
      <h4 onclick="loadInflationInfo()">üìà Inflation Rates</h4>
      <h4 onclick="loadAvailabilityInfo()">üè≠ Silver Availability</h4>
      <h4 onclick="loadRenewableInfo()">‚ö° Renewable Energy Impact</h4>
      <h4 onclick="loadGeopoliticalInfo()">üåç Geopolitical</h4>
      <div class="sub-options">
        <span onclick="loadGeopoliticalInfo()">Global Factors</span>
        <span onclick="loadTradeInfo()">Trade Disputes</span>
      </div>
      <h4 onclick="loadForecast()">üîÆ AI Forecast (LSTM)</h4>
    </div>
    <div class="graph-section" id="contentArea">
      <h2 style="color:#8b1e2d;margin-bottom:20px;">Select an option from the menu</h2>
      <div class="time-selector">
        <button class="selected" onclick="selectTime(this,'weekly')">Weekly</button>
        <button onclick="selectTime(this,'monthly')">Monthly</button>
        <button onclick="selectTime(this,'quarterly')">Quarterly</button>
        <button onclick="selectTime(this,'half-yearly')">Half Yearly</button>
      </div>
    </div>
  </div>
</div>

<div class="nav-ui">
  <button onclick="back()">‚Üê BACK</button>
  <button onclick="forward()">FORWARD ‚Üí</button>
</div>

<script>
const API_BASE = '/api'; // FIXED: Removed localhost
let selectedRole = null;
let historyStack = [1];
let currentIndex = 0;
let currentPeriod = 'weekly';

function go(n){
  document.querySelectorAll('.page').forEach(p=>p.classList.remove('active'));
  if(n==='main'){
    document.getElementById('main').classList.add('active');
    loadPriceChart('monthly'); 
  } else {
    document.getElementById('p'+n).classList.add('active');
  }
  historyStack = historyStack.slice(0,currentIndex+1);
  historyStack.push(n);
  currentIndex++;
}

function back(){
  if(currentIndex > 0){
    currentIndex--;
    show(historyStack[currentIndex]);
  }
}

function forward(){
  if(currentIndex < historyStack.length-1){
    currentIndex++;
    show(historyStack[currentIndex]);
  }
}

function show(n){
  document.querySelectorAll('.page').forEach(p=>p.classList.remove('active'));
  if(n==='main'){
    document.getElementById('main').classList.add('active');
  } else {
    document.getElementById('p'+n).classList.add('active');
  }
}

function mode(type){
  const f=document.getElementById('fields');
  const t=document.getElementById('title');
  const s=document.getElementById('subtitle');
  f.innerHTML='';
  if(type==='login'){
    t.innerText='LOG IN';
    s.innerText='secure silver access';
    f.innerHTML=`<input type="text" placeholder="Username"><input type="password" placeholder="Passcode">`;
  }
  if(type==='signup'){
    t.innerText='REGISTER';
    s.innerText='create secure vault';
    f.innerHTML=`<input type="tel" placeholder="Mobile Number"><input type="email" placeholder="Email"><input type="password" placeholder="New Passcode">`;
  }
  if(type==='guest'){
    t.innerText='GUEST';
    s.innerText='limited exploration';
    f.innerHTML='<p style="color:#8b1e2d;">Proceeding as guest - full features available</p>';
  }
  go(3);
}

function proceedFromVerify(){
  const title = document.getElementById('title').innerText;
  if(title==='GUEST'){ go(4); } else { go('main'); }
}

function selectRole(btn,role){
  selectedRole = role;
  document.querySelectorAll('#p4 .options button').forEach(b=>b.classList.remove('selected'));
  btn.classList.add('selected');
  setTimeout(() => go('main'), 500);
}

function toggleNav(){
  document.getElementById('sidebar').classList.toggle('active');
}

function selectTime(btn, period){
  currentPeriod = period;
