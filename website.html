<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <link rel="stylesheet" href="style.css">
    <title>silvermoonlight</title>
</head>
<body>

<div class="container">
  <div class="page active" id="p1">
    <div class="layout">
      <div class="text">
        <h1>silvermoonlight</h1>
        <p>get updated on your silver stocks daily</p>
        <button onclick="go(2)">ENTER</button>
      </div>
      <div class="visual">
        <img src="silver face1.jpeg" alt="Silver Analysis">
      </div>
    </div>
  </div>

  <div class="page" id="p2">
    <div class="layout">
      <div class="text">
        <h1>ACCESS</h1>
        <p>choose your path</p>
        <div class="options">
          <button onclick="mode('login')">LOG IN</button>
          <button onclick="mode('guest')">EXPLORE AS GUEST</button>
          <button onclick="mode('signup')">SIGN UP</button>
        </div>
      </div>
      <div class="visual">
        <img src="silver thing1.jpeg" alt="Access Portal">
      </div>
    </div>
  </div>

  <div class="page" id="p3">
    <div class="layout">
      <div class="text">
        <h1 id="title">VERIFY</h1>
        <p id="subtitle"></p>
        <div class="inputs" id="fields"></div>
        <button onclick="proceedFromVerify()">PROCEED</button>
      </div>
      <div class="visual">
        <img src="silversilver.jpeg" alt="Verification">
      </div>
    </div>
  </div>

  <div class="page" id="p4">
    <div class="layout">
      <div class="text">
        <h1>OCCUPATION</h1>
        <p>select your role</p>
        <div class="options">
          <button onclick="selectRole(this,'First time here')">First time here</button>
          <button onclick="selectRole(this,'Beginner')">Beginner</button>
          <button onclick="selectRole(this,'Advanced')">Advanced</button>
          <button onclick="selectRole(this,'Professional')">Professional</button>
          <button onclick="selectRole(this,'Other')">Other</button>
        </div>
        <button style="margin-top:20px;" onclick="go(2)">Log in to your account</button>
      </div>
      <div class="visual">
        <img src="silver2.jpeg" alt="Profile">
      </div>
    </div>
  </div>

  <div class="page" id="main">
    <div id="navToggle" onclick="toggleNav()">
      <div></div><div></div><div></div>
    </div>
    <div id="sidebar">
      <h3 onclick="loadPriceChart('monthly')">üìä Prices</h3>
      <h4 onclick="loadGoldComparison()">üí∞ Gold vs Silver</h4>
      <h4 onclick="loadInfo('/api/inflation')">üìà Inflation Rates</h4>
      <h4 onclick="loadInfo('/api/availability')">üè≠ Availability</h4>
      <h4 onclick="loadInfo('/api/renewable-energy')">‚ö° Renewable Impact</h4>
      <h4 onclick="loadInfo('/api/geopolitical')">üåç Geopolitical</h4>
      <h4 onclick="loadForecast()">üîÆ AI Forecast (LSTM)</h4>
    </div>
    <div class="graph-section" id="contentArea">
      <div id="displayOutput">
        <h2 style="color:#8b1e2d;margin-bottom:20px;">Select an option from the menu</h2>
      </div>
      <div class="time-selector" id="timeSelector" style="display:none;">
        <button onclick="loadPriceChart('weekly')">Weekly</button>
        <button onclick="loadPriceChart('monthly')">Monthly</button>
        <button onclick="loadPriceChart('quarterly')">Quarterly</button>
        <button onclick="loadPriceChart('half-yearly')">Half Yearly</button>
      </div>
    </div>
  </div>
</div>

<div class="nav-ui">
  <button onclick="back()">‚Üê BACK</button>
  <button onclick="forward()">FORWARD ‚Üí</button>
</div>

<script>
const API_BASE = '/api';
let historyStack = [1];
let currentIndex = 0;

// Navigation Logic
function go(n){
  document.querySelectorAll('.page').forEach(p=>p.classList.remove('active'));
  if(n==='main'){
    document.getElementById('main').classList.add('active');
    loadPriceChart('monthly');
  } else {
    document.getElementById('p'+n).classList.add('active');
  }
  historyStack = historyStack.slice(0,currentIndex+1);
  historyStack.push(n);
  currentIndex++;
}

function back(){
  if(currentIndex > 0){
    currentIndex--;
    show(historyStack[currentIndex]);
  }
}

function forward(){
  if(currentIndex < historyStack.length-1){
    currentIndex++;
    show(historyStack[currentIndex]);
  }
}

function show(n){
  document.querySelectorAll('.page').forEach(p=>p.classList.remove('active'));
  if(n==='main'){ document.getElementById('main').classList.add('active'); }
  else { document.getElementById('p'+n).classList.add('active'); }
}

// Access Modes
function mode(type){
  const f=document.getElementById('fields');
  const t=document.getElementById('title');
  const s=document.getElementById('subtitle');
  f.innerHTML='';
  if(type==='login'){
    t.innerText='LOG IN';
    s.innerText='secure silver access';
    f.innerHTML=`<input type="text" placeholder="Username"><input type="password" placeholder="Passcode">`;
  } else if(type==='signup'){
    t.innerText='REGISTER';
    s.innerText='create secure vault';
    f.innerHTML=`<input type="tel" placeholder="Mobile Number"><input type="email" placeholder="Email"><input type="password" placeholder="New Passcode">`;
  } else {
    t.innerText='GUEST';
    s.innerText='limited exploration';
    f.innerHTML='<p style="color:#8b1e2d;">Proceeding as guest - full features available</p>';
  }
  go(3);
}

function proceedFromVerify(){
  const title = document.getElementById('title').innerText;
  if(title==='GUEST'){ go(4); } else { go('main'); }
}

function selectRole(btn,role){
  document.querySelectorAll('#p4 .options button').forEach(b=>b.classList.remove('selected'));
  btn.classList.add('selected');
  setTimeout(() => go('main'), 500);
}

function toggleNav(){
  document.getElementById('sidebar').classList.toggle('active');
}

// --- DATA FETCHING FUNCTIONS ---

async function loadPriceChart(period) {
  const content = document.getElementById('displayOutput');
  document.getElementById('timeSelector').style.display = 'flex';
  content.innerHTML = '<p>Loading Price Data...</p>';
  
  try {
    const res = await fetch(`${API_BASE}/chart/${period}`);
    const data = await res.json();
    content.innerHTML = `
      <h3>Current Price: ‚Çπ${data.current_price} (${data.price_change}%)</h3>
      <p>Market Sentiment: <strong>${data.sentiment}</strong></p>
      <img src="${data.image}" style="width:100%; border-radius:10px; margin-top:10px;">
    `;
  } catch (e) { content.innerHTML = '<p>Error loading chart.</p>'; }
}

async function loadGoldComparison() {
  const content = document.getElementById('displayOutput');
  document.getElementById('timeSelector').style.display = 'none';
  content.innerHTML = '<p>Comparing Assets...</p>';
  
  try {
    const res = await fetch(`${API_BASE}/compare-gold`);
    const data = await res.json();
    content.innerHTML = `
      <h3>Better Performer: ${data.better_performer}</h3>
      <img src="${data.image}" style="width:100%; border-radius:10px;">
    `;
  } catch (e) { content.innerHTML = '<p>Error loading comparison.</p>'; }
}

async function loadForecast() {
  const content = document.getElementById('displayOutput');
  document.getElementById('timeSelector').style.display = 'none';
  content.innerHTML = '<p>Running LSTM Model (may take 30s)...</p>';
  
  try {
    const res = await fetch(`${API_BASE}/forecast`);
    const data = await res.json();
    content.innerHTML = `
      <h3>30-Day Forecast Trend: ${data.trend}</h3>
      <p>Confidence: ${data.confidence}</p>
      <img src="${data.image}" style="width:100%; border-radius:10px;">
    `;
  } catch (e) { content.innerHTML = '<p>Error loading forecast.</p>'; }
}

async function loadInfo(endpoint) {
  const content = document.getElementById('displayOutput');
  document.getElementById('timeSelector').style.display = 'none';
  
  try {
    const res = await fetch(endpoint);
    const data = await res.json();
    content.innerHTML = `<h3>${data.title}</h3><p>${data.summary || data.key_points.join('<br>')}</p>`;
  } catch (e) { content.innerHTML = '<p>Error loading info.</p>'; }
}
</script>

</body>
</html>
